{
  "hash": "30981e0668d91578b27152153c7e724a",
  "result": {
    "markdown": "---\ntitle: \"Afficher des outputs de régression avec Jtools\"\n\n# subtitle: \"\"\n\ncategories:\n  - Output\n  \nauthor: \n  - name: \"Marc Thévenin\"\n    affiliations:\n      - name: \"Ined\"\n\ndate: 06/21/2023\n\nimage: \"https://jtools.jacob-long.com/logo.png\"\n\nformat: \n  html: default\n  docx: default\n#  pdf:  default\n\n#filters:\n#   - lightbox\n#lightbox: auto\n\ncode-annotations: below\n\nabstract: | \n La fonction `summ` du package jtools (Jacob Long) permet d'obtenir des outputs de regression en format console de très bonne qualité. Il s'agit d'une très bonne alternative aux outputs par défaut. Ce package propose également des fonctionnalités d'exportation des outputs dans d'autres formats (html, docx, pdf ...) et des visualisations sous forme de graphique. Ces fonctionnalité ne seront pas traitées ici, l'accent étant mis sur la qualité d'un output console avec une durée d'exécution minimale. L'utilisation des fonctionnalités d'exportation, comme le très populaire package **`gtsummaty`** devrait être appliqué, selon nous, pour des raisons de durée d'exécution à un résultat final.\n---\n\n\n\n| Packages      | Fonctions                                       |\n|---------------|-------------------------------------------------|\n| **jtools**    | `summ`                                          |\n| **survey**    | `svydesign` `svyglm`                            |\n| **Base R**    | `lm` `glm`                                      |\n\n\n![](https://jtools.jacob-long.com/logo.png){width=15%}\n\n\n- [Documentation du package **jtools** (Jacob Long)](https://jtools.jacob-long.com/index.html)\n- A ce jour, la maintenance du package est assurée [version 2.2.1 à juin 2023] \n- Les nombre de modèles pris en charge par le package est malheureusement assez réduit. On notera cependant la prise en charge de la fonction `svyglm` du package survey. \n- Les fonctionnalités d'exportation ne seront pas traitées ici. \n\n# **Installation**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"jtools\")\n```\n:::\n\n\n\nou \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"devtools\")\ndevtools::install_github(\"jacob-long/jtools\")\n```\n:::\n\n\n\n\n# **Syntaxe de la fonction `summ()`**  \n\nLa syntaxe est particulièrement simple, elle consiste juste à appliquée à la fonction `summ()` l'objet généré par la régression. Quelques options comme `digits`, `confint`, `exp` permettent d'améliorer et enrichir l'output.\n\n\n\n::: {.cell filename='syntaxe minimale'}\n\n```{.r .cell-code}\nfit = lm(y ~ x , data=df)\nsumm(fit)\n```\n:::\n\n\n\n\n# **Exemples [^1]**\n\n[^1]: mesure de la tension artérielle (`lm`) et du risque d'hypertension (`glm` et `svyglm`)\n\n\n## Avec la fonction `lm()`\n\n[Liste des options](https://jtools.jacob-long.com/reference/summ.lm.html)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(jtools)\nlibrary(readr)\n\ndf =  read.csv(\"https://raw.githubusercontent.com/mthevenin/intro_logit/main/hypertension2.csv\")\n\nfit = lm(bpsystol ~ age + I(sex) + I(black) + I(region), data=df)\n\nsumm(fit, digits=4)  #<1>                                                       \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 10351 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> bpsystol </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(6,10344) </td>\n   <td style=\"text-align:right;\"> 552.2494 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.2426 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.2422 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 102.2001 </td>\n   <td style=\"text-align:right;\"> 0.8979 </td>\n   <td style=\"text-align:right;\"> 113.8168 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 0.6563 </td>\n   <td style=\"text-align:right;\"> 0.0116 </td>\n   <td style=\"text-align:right;\"> 56.5104 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(sex)Male </td>\n   <td style=\"text-align:right;\"> 4.0350 </td>\n   <td style=\"text-align:right;\"> 0.3999 </td>\n   <td style=\"text-align:right;\"> 10.0911 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(black)Not Black </td>\n   <td style=\"text-align:right;\"> -4.6494 </td>\n   <td style=\"text-align:right;\"> 0.6640 </td>\n   <td style=\"text-align:right;\"> -7.0019 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)NE </td>\n   <td style=\"text-align:right;\"> 0.2570 </td>\n   <td style=\"text-align:right;\"> 0.5892 </td>\n   <td style=\"text-align:right;\"> 0.4362 </td>\n   <td style=\"text-align:right;\"> 0.6627 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)S </td>\n   <td style=\"text-align:right;\"> -0.7920 </td>\n   <td style=\"text-align:right;\"> 0.5450 </td>\n   <td style=\"text-align:right;\"> -1.4532 </td>\n   <td style=\"text-align:right;\"> 0.1462 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)W </td>\n   <td style=\"text-align:right;\"> -0.5221 </td>\n   <td style=\"text-align:right;\"> 0.5543 </td>\n   <td style=\"text-align:right;\"> -0.9420 </td>\n   <td style=\"text-align:right;\"> 0.3462 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n\n\n1. digits=4 => Les résultats sont reportés avec 4 décimales      \n\n\n## Avec la fonction `glm()` [lien logit]\n\n[Liste des options](https://jtools.jacob-long.com/reference/summ.glm.html)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit = glm(highbp ~ age + I(sex) + I(black) + I(region), family=binomial, data=df)   \n\nsumm(fit, digits=4, confint=TRUE, exp=TRUE)                                           #<1>\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 10351 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> highbp </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> χ²(6) </td>\n   <td style=\"text-align:right;\"> 1623.1601 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.1951 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.1151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 12492.3709 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> BIC </td>\n   <td style=\"text-align:right;\"> 12543.0848 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> z val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.0853 </td>\n   <td style=\"text-align:right;\"> 0.0701 </td>\n   <td style=\"text-align:right;\"> 0.1038 </td>\n   <td style=\"text-align:right;\"> -24.5720 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.0496 </td>\n   <td style=\"text-align:right;\"> 1.0469 </td>\n   <td style=\"text-align:right;\"> 1.0524 </td>\n   <td style=\"text-align:right;\"> 36.1832 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(sex)Male </td>\n   <td style=\"text-align:right;\"> 1.5483 </td>\n   <td style=\"text-align:right;\"> 1.4223 </td>\n   <td style=\"text-align:right;\"> 1.6856 </td>\n   <td style=\"text-align:right;\"> 10.0890 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(black)Not Black </td>\n   <td style=\"text-align:right;\"> 0.5860 </td>\n   <td style=\"text-align:right;\"> 0.5092 </td>\n   <td style=\"text-align:right;\"> 0.6742 </td>\n   <td style=\"text-align:right;\"> -7.4663 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)NE </td>\n   <td style=\"text-align:right;\"> 1.1655 </td>\n   <td style=\"text-align:right;\"> 1.0287 </td>\n   <td style=\"text-align:right;\"> 1.3203 </td>\n   <td style=\"text-align:right;\"> 2.4051 </td>\n   <td style=\"text-align:right;\"> 0.0162 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)S </td>\n   <td style=\"text-align:right;\"> 1.0024 </td>\n   <td style=\"text-align:right;\"> 0.8930 </td>\n   <td style=\"text-align:right;\"> 1.1253 </td>\n   <td style=\"text-align:right;\"> 0.0414 </td>\n   <td style=\"text-align:right;\"> 0.9669 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)W </td>\n   <td style=\"text-align:right;\"> 1.0966 </td>\n   <td style=\"text-align:right;\"> 0.9746 </td>\n   <td style=\"text-align:right;\"> 1.2338 </td>\n   <td style=\"text-align:right;\"> 1.5322 </td>\n   <td style=\"text-align:right;\"> 0.1255 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: MLE</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n\n1. On ajoute des intervalles de confiance (`confint=TRUE`) et le report des estimateurs sous forme d'Odds Ratio (`exp=TRUE`)\n\n\n\n## Avec la fonction `svyglm()` [lien logit]\n\n[Liste des options](https://jtools.jacob-long.com/reference/summ.svyglm.html)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\n\nw = svydesign(id=~1, weights=~w, data=df)\n\nfit = svyglm(highbp ~ age + I(sex) + I(black) + I(region), family=binomial, design=w)\nsumm(fit, digits=4, confint=TRUE, exp=TRUE)    \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 10351 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> highbp </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> Survey-weighted generalized linear model </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Family </td>\n   <td style=\"text-align:right;\"> binomial </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Link </td>\n   <td style=\"text-align:right;\"> logit </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (Cragg-Uhler) </td>\n   <td style=\"text-align:right;\"> 0.1881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Pseudo-R² (McFadden) </td>\n   <td style=\"text-align:right;\"> 0.1125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AIC </td>\n   <td style=\"text-align:right;\"> 12064.1922 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.0692 </td>\n   <td style=\"text-align:right;\"> 0.0553 </td>\n   <td style=\"text-align:right;\"> 0.0865 </td>\n   <td style=\"text-align:right;\"> -23.3763 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.0530 </td>\n   <td style=\"text-align:right;\"> 1.0497 </td>\n   <td style=\"text-align:right;\"> 1.0562 </td>\n   <td style=\"text-align:right;\"> 33.0767 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(sex)Male </td>\n   <td style=\"text-align:right;\"> 1.8298 </td>\n   <td style=\"text-align:right;\"> 1.6529 </td>\n   <td style=\"text-align:right;\"> 2.0256 </td>\n   <td style=\"text-align:right;\"> 11.6459 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(black)Not Black </td>\n   <td style=\"text-align:right;\"> 0.5849 </td>\n   <td style=\"text-align:right;\"> 0.4913 </td>\n   <td style=\"text-align:right;\"> 0.6964 </td>\n   <td style=\"text-align:right;\"> -6.0259 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)NE </td>\n   <td style=\"text-align:right;\"> 1.1822 </td>\n   <td style=\"text-align:right;\"> 1.0245 </td>\n   <td style=\"text-align:right;\"> 1.3642 </td>\n   <td style=\"text-align:right;\"> 2.2906 </td>\n   <td style=\"text-align:right;\"> 0.0220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)S </td>\n   <td style=\"text-align:right;\"> 0.9961 </td>\n   <td style=\"text-align:right;\"> 0.8670 </td>\n   <td style=\"text-align:right;\"> 1.1445 </td>\n   <td style=\"text-align:right;\"> -0.0549 </td>\n   <td style=\"text-align:right;\"> 0.9562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> I(region)W </td>\n   <td style=\"text-align:right;\"> 1.1225 </td>\n   <td style=\"text-align:right;\"> 0.9737 </td>\n   <td style=\"text-align:right;\"> 1.2940 </td>\n   <td style=\"text-align:right;\"> 1.5928 </td>\n   <td style=\"text-align:right;\"> 0.1112 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: Robust</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n",
    "supporting": [
      "jtools_output_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}