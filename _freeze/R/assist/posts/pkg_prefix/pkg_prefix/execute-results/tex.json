{
  "hash": "0ac84ae2efcd34d5625917b75db7bf4e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Consolider sa reproductibilité avec le package prefixer\"\n\ndate: 10/24/2023\n  \ncategories:\n  - Addins\n  - Reproductibilité\n\nimage: \"http://github.com/dreamRs/prefixer/raw/master/man/figures/logo_prefixer.png\"\n\nauthor: \n  - name: \"Bénédicte Garnier\"\n    affiliations:\n      - name: \"Ined\"\n\nlightbox: true\n\nabstract: | \n  Il est très simple d'ajouter, dans un script R, les noms des packages aux appels des fonctions. Sous forme de préfixes, ces indications permettent de repérer les packages utilisés et donc faciliter la reproductibilité de l'analyse. Nous prenons ici l'exemple d'un script générant un nuage de mots à partir du package de statistique textuelle R.temis. \n \nformat: \n  html: default\n  pdf: default\n  docx: default\n  odt: default\n\ntoc: true  \n---\n\n::: {.cell}\n\n:::\n\n\n\n\n\n| Packages        | Fonctions                                 |\n|-----------------|-------------------------------------------|\n| **prefixer**    | `prefixer`                                |\n| **R.temis**     | `import_corpus`                           |\n| **R.temis**     | `build_dtm`                               |\n| **R.temis**     | `frequent_terms`                          |\n| **R.temis**     | `combine_terms`                           |\n| **R.temis**     | `word_cloud`                              |\n\n\n: **Fonctions utilisées dans la fiche**\n\nPour illustrer ce propos, nous reprennons le script de la fiche de Coralie Cottet [*Générer des graphes de mot avec R.temis*](http://mthevenin.github.io/assistoolsms/R/assist/posts/nuage_de_mot/nuage_de_mot.html). Nous allons ajouter un prefixe à chaque fonction utilisée pour générer un nuage de mots. \n\n\n**Documentation** :\n\n-   [**RStudio Addins**](http://docs.posit.co/ide/user/ide/guide/productivity/add-ins.html) sont des extensions pour l'environnement de développement intégré (IDE) RStudio\n\n-   [**prefixer: Shiny Gadget to interactively prefix function in a script **](http://rdrr.io/github/dreamRs/prefixer/man/prefixer.html)\n\n-   Séminaire R à l'Usage des Sciences Sociales, [*Esquisse, moins tu sais coder plus tu vas rigoler*](http://russ.site.ined.fr/fr/annee-2022-2023/esquisse/)\n\n\n**Installation des packages** : \n\n```markdown\ninstall.packages(\"remotes\")\ninstall.packages(\"R.temis\")\ninstall.packages(\"dyplyr\")\n\n```\n\n**Fichiers à utilisés** :\n\nLes [voeux du président Hollande pour les années 2013 à 2017](http://www.vie-publique.fr/discours-dans-lactualite/269998-les-voeux-des-presidents-de-la-republique-depuis-1974). \n\nChaque discours correspond à un fichier texte et ces 5 discours sont placés dans un dossier unique appelé *dossier_de_textes*  \n\n# Le script d'origine\n\n\n\n::: {.cell class='scroll_output'}\n\n```{.r .cell-code  code-fold=\"true\"}\n## Appel des packages\nlibrary(R.temis)\nlibrary(tidyverse)\n\n## Statistiques textuelles\n## Création du tableau lexical associé au corpus des discours\n\n# Importation des textes avec la fonction `import_corpus`\ncorpusv <- import_corpus(\"datas/dossier_de_textes\", format=\"txt\", language =\"fr\")\n\n# Création du tableau lexical associé \n# On ne garde pas les mots-outils et on garde aussi les mots de 1 seule lettre\n\ndtm <-build_dtm(corpusv, remove_stopwords = T, min_length = 1)\ndtm\n\n# On obtient un *tableau lexical* de 5 unités de texte (les voeux) et 1575 mots différents ...  \n\n\n## Afficher les occurrences des mots du corpus\n# Calcul des occurrences des mots \nfrequent_terms(dtm) \n\n# On remarque que les mots `tous`, `tout` et `toutes` sont très fréquents et qu ils sont employés dans des contextes similaires. On souhaite alors les associer à un terme unique : `tous.tes` (opération de `lemmatisation`)\n\n#### Personalisation du lexique\n\n# Création du dictionnaire/lexique associé au tableau lexical \ndic <-dictionary(dtm) \n\n# On crée une nouvelle table `dic2` en créant une première colonne appelée `word`  avec l'intitulé des lignes du tableau et en remplaçant le contenu de la colonne cette première colonne ... C'est un lemmatiseur !\ndic2 = dic %>%\n  rownames_to_column(var=\"word\") %>% \n  mutate(Term = word)\n\nrow.names(dic2) <- dic2$word\n\n# On peut alors remplacer les mots de la colonne Term par l'intitulé souhaité. Ici tout.tes\ndic2$Term[dic2$word == \"toutes\"] <- \"tous.tes\"\ndic2$Term[dic2$word == \"tout\"] <- \"tous.tes\"\ndic2$Term[dic2$word == \"tous\"] <- \"tous.tes\"\n\n# Lemmatisation à l'aide du lemmatiseur personnalisé\ndtmlem <-combine_terms(dtm, dic2)\n\n# Ensemble de mots à retirer\nmots_a_retirer <- c(\"a\", \"plus\")\n\n# Suppression de mots dans le tableau lexical\ndtm2<-dtmlem[, !colnames(dtmlem) %in% mots_a_retirer]\n\n# Nouvelles fréquences des mots associés au corpus\nfrequent_terms(dtm2)\n\n\n### Affichage du nuage de mots\n\ncloud<-word_cloud(dtm2, color= 'black', min.freq=1,n =50) \ntitle(main = \"Mots les plus fréquents dans les discours de F. Hollande entre 2013 et 2017\")\n```\n:::\n\n\n\n\n# Ajouter le nom des packages aux fonctions avec `prefixer`\n\n## Installer le package *prefixer* à partir de GitHub\n\nL'addin prefix est disponible sur la forge logicielle de *dreamRs*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"remotes\")\ninstall_github(\"dreamRs/prefixer\")\n```\n:::\n\n\n\n\nCelui-ci permet d'ouvrir une interface qui propose pour chaque fonction du script de lui ajouter un préfixe composé du nom de la fonction suivi de `::`\n\n::: {.column width=\"65%\"}\n::: {.box_img}\n![](img/img1.png)\n:::\n:::\n\n## Prefixer le script\n\nA la fin du script R, on charge le package `prefixer` puis on ouvre l'interface avec la commande `prefixer()` \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Appel du package\nlibrary(prefixer)\n## Ouverture de l'interface RShiny\nprefixer()\n```\n:::\n\n\n\nDans le cas de notre script: \n\n```{.r}\n#cloud<-word_cloud(dtm2, color= 'black', min.freq=1,n =50) \n#title(main = \"Mots les plus fréquents dans les discours de F. Hollande entre 2013 et 2017\")\n\nlibrary(prefixer)\nprefixer()\n```\n\n\n## Utiliser la fenêtre shiny permettant de choisir le préfixe \n\n::: callout-note\nSeulement pour le format html\n:::\n\n::: {.content-visible when-format=\"html\"}\n::: {.column width=\"65%\"}\n::: {.box_img}\n![](img/mov1.gif)\n:::\n:::\n:::\n\n\n# Résultat: le script est enrichi\n\n\n\n::: {.cell class='scroll_output'}\n\n```{.r .cell-code}\n## Statistiques textuelles\n## Création du tableau lexical associé au corpus des discours\n\n# Importation des textes avec la fonction `import_corpus`\ncorpusv <- R.temis::import_corpus(\"datas/dossier_de_textes\", format=\"txt\", language =\"fr\")\n\n# Création du tableau lexical associé \n# On ne garde pas les mots-outils et on garde aussi les mots de 1 seule lettre\n\ndtm <-R.temis::build_dtm(corpusv, remove_stopwords = T, min_length = 1)\ndtm\n\n# On obtient un *tableau lexical* de 5 unités de texte (les voeux) et 1575 mots différents ...  \n\n\n## Afficher les occurrences des mots du corpus\n# Calcul des occurrences des mots \nR.temis::frequent_terms(dtm) \n\n\n# On remarque que les mots `tous`, `tout` et `toutes` sont très fréquents et qu ils sont employés dans des contextes similaires. On souhaite alors les associer à un terme unique : `tous.tes` (opération de `lemmatisation`)\n\n#### Personalisation du lexique\n\n# Création du dictionnaire/lexique associé au tableau lexical \ndic <-R.temis::dictionary(dtm) \n\n# On crée une nouvelle table `dic2` en créant une première colonne appelée `word`  avec l'intitulé des lignes du tableau et en remplaçant le contenu de la colonne cette première colonne ... C'est un lemmatiseur !\ndic2 = dic %>%\n  tibble::rownames_to_column(var=\"word\") %>% \n  dplyr::mutate(Term = stringr::word)\n\nrow.names(dic2) <- dic2$word\n\n# On peut alors remplacer les mots de la colonne Term par l'intitulé souhaité. Ici tout.tes\ndic2$Term[dic2$word == \"toutes\"] <- \"tous.tes\"\ndic2$Term[dic2$word == \"tout\"] <- \"tous.tes\"\ndic2$Term[dic2$word == \"tous\"] <- \"tous.tes\"\n\n# Lemmatisation à l'aide du lemmatiseur personnalisé\ndtmlem <-R.temis::combine_terms(dtm, dic2)\n\n# Ensemble de mots à retirer\nmots_a_retirer <- c(\"a\", \"plus\")\n\n# Suppression de mots dans le tableau lexical\ndtm2<-dtmlem[, !colnames(dtmlem) %in% mots_a_retirer]\n\n# Nouvelles fréquences des mots associés au corpus\nR.temis::frequent_terms(dtm2)\n\n\n### Affichage du nuage de mots\n\ncloud<-R.temis::word_cloud(dtm2, color= 'black', min.freq=1,n =50) \ntitle(main = \"Mots les plus fréquents dans les discours de F. Hollande entre 2013 et 2017\")\n```\n:::\n",
    "supporting": [
      "pkg_prefix_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}