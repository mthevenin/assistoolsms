<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Coralie Cottet">

<title>SMS_site - Réaliser des cartes thématiques avec Mapsf</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


<link rel="stylesheet" href="../../../../sms.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../img/coding2.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../R/index.html" rel="" target="">
 <span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../Autres/index.html" rel="" target="">
 <span class="menu-text">Othe-R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../supports.html" rel="" target="">
 <span class="menu-text">Autres Supports</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Réaliser des cartes thématiques avec Mapsf</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Montrer tout le code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Cacher tout le code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Voir les sources</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Cartographie</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Auteur·rice</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Coralie Cottet </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Ensai-Ined
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Date de publication</div>
      <div class="quarto-title-meta-contents">
        <p class="date">27 juillet 2023</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Résumé</div>
      <p>Nous allons montrer comment réaliser des cartes avec R à l’aide du package <strong><code>mapsf</code></strong> (T.Giraud) et du packages <strong><code>sf</code></strong>. mapsf est un outil très utile pour manipuler et visualiser des données spatiales en R, tandis que le package “sf” fournit une infrastructure pour stocker et manipuler ce type de données. Ces deux packages offrent une solution simple et pratique pour réaliser ce type d’analyse.</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#importation-des-données" id="toc-importation-des-données" class="nav-link active" data-scroll-target="#importation-des-données">Importation des données</a></li>
  <li><a href="#différents-types-de-cartes" id="toc-différents-types-de-cartes" class="nav-link" data-scroll-target="#différents-types-de-cartes">Différents types de cartes</a>
  <ul class="collapse">
  <li><a href="#les-cartes-à-symboles-proportionnels" id="toc-les-cartes-à-symboles-proportionnels" class="nav-link" data-scroll-target="#les-cartes-à-symboles-proportionnels">Les cartes à symboles proportionnels</a></li>
  <li><a href="#les-cartes-choroplèthes" id="toc-les-cartes-choroplèthes" class="nav-link" data-scroll-target="#les-cartes-choroplèthes">Les cartes choroplèthes</a></li>
  <li><a href="#les-cartes-pour-une-variable-qualitative-nominale" id="toc-les-cartes-pour-une-variable-qualitative-nominale" class="nav-link" data-scroll-target="#les-cartes-pour-une-variable-qualitative-nominale">Les cartes pour une variable qualitative nominale</a></li>
  </ul></li>
  <li><a href="#pour-aller-plus-loin-regroupement-de-polygones" id="toc-pour-aller-plus-loin-regroupement-de-polygones" class="nav-link" data-scroll-target="#pour-aller-plus-loin-regroupement-de-polygones">Pour aller plus loin: regroupement de polygones</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="logo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="logo.png" class="img-fluid figure-img" style="width:10.0%"></a></p>
</figure>
</div>
<p><strong>Documentation</strong> (Timothé Giraud):</p>
<ul>
<li><p><a href="https://rcarto.github.io/ined2022/07_mise_en_page.html" class="uri">https://rcarto.github.io/ined2022/07_mise_en_page.html</a></p></li>
<li><p><a href="http://riatelab.github.io/mapsf" class="uri">http://riatelab.github.io/mapsf</a></p></li>
<li><p><a href="http://rgeomatic.hypotheses.org/2077" class="uri">http://rgeomatic.hypotheses.org/2077</a></p></li>
</ul>
<p><strong>Installation des packages</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a>install.packages(mapsf)</span>
<span id="cb1-2"><a href="#cb1-2"></a>install.packages(sf)</span>
<span id="cb1-3"><a href="#cb1-3"></a>install.packages(dplyr)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(mapsf)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous allons réaliser une carte de Paris avec les données du site de Paris Data [<a href="http://opendata.paris.fr/pages/catalogue/?disjunctive.theme&amp;disjunctive.publisher">Lien</a>]</p>
<section id="importation-des-données" class="level1">
<h1>Importation des données</h1>
<p>Il existe plusieurs formats de fond de carte:</p>
<ul>
<li><p><strong>GeoJSON</strong> est un format de données géospatiales basé sur JSON (JavaScript Object Notation) qui permet de stocker des données géographiques sous forme de caractères.</p></li>
<li><p><strong>Shapefile</strong> est un format de données géospatiales propriétaire développé par <em>Esri</em> (Environmental Systems Research Institute). Il est constitué de plusieurs fichiers qui stockent des informations sur les entités géographiques telles que les points, les lignes et les polygones, ainsi que des attributs associés à ces entités.</p></li>
</ul>
<p>Ici le fond importé est en format <em>GeoJSON</em>, il correspond aux limites des arrondissements. On va lui ajouter celui des voies d’eau en couche d’habillage.</p>
<div class="cell" data-result="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Importation des données</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>arrondissements <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"https://opendata.paris.fr/explore/dataset/arrondissements/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `OGRGeoJSON' from data source 
  `https://opendata.paris.fr/explore/dataset/arrondissements/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr' 
  using driver `GeoJSON'
Simple feature collection with 20 features and 9 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 2.224078 ymin: 48.81558 xmax: 2.469761 ymax: 48.90216
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>cours_deau<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/plan-de-voirie-voies-deau/exports/geojson?lang=fr&amp;timezone=Europe%2FBerlin"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `OGRGeoJSON' from data source 
  `https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/plan-de-voirie-voies-deau/exports/geojson?lang=fr&amp;timezone=Europe%2FBerlin' 
  using driver `GeoJSON'
Simple feature collection with 58 features and 25 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.224081 ymin: 48.81924 xmax: 2.450555 ymax: 48.90207
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Affichage du fond de carte des arrondissements avec cours d'eau</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Arrondissements</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements, <span class="at">border =</span> <span class="st">"black"</span>) </span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Ajout des cours d'eau</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">mf_map</span>(<span class="at">x=</span>cours_deau,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">border=</span><span class="st">"lightblue"</span>,<span class="at">col=</span><span class="st">"lightblue"</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="map_sf_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="map_sf_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Fond noir</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">mf_theme</span>(<span class="st">"darkula"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="différents-types-de-cartes" class="level1">
<h1>Différents types de cartes</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="arbre_type_data.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="arbre_type_data.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<section id="les-cartes-à-symboles-proportionnels" class="level2">
<h2 class="anchored" data-anchor-id="les-cartes-à-symboles-proportionnels">Les cartes à symboles proportionnels</h2>
<p>La carte en symboles proportionnels est la méthode de représentation graphique à utiliser pour visualiser des variables de stocks (variables quantitatives absolues pour lesquelles la somme et la moyenne ont une signification).</p>
<p>Sur la carte, on affiche l’effectif de la population de chaque arrondissement et on ajoute la légende et un titre.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#Ajout manuel des valeurs des populations de chaque arrondissements dans le tableau sous le nom "pop"</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>arrondissements<span class="sc">$</span>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1012687</span>, <span class="dv">903036</span>, <span class="dv">1369857</span>, <span class="dv">1491027</span>, <span class="dv">1672009</span>, <span class="dv">1506475</span>, <span class="dv">1637163</span>, <span class="dv">1603380</span>, <span class="dv">1637542</span>, <span class="dv">1059282</span>, <span class="dv">1494945</span>, <span class="dv">1436205</span>, <span class="dv">1705774</span>, <span class="dv">1425805</span>, <span class="dv">236769</span>, <span class="dv">1668605</span>, <span class="dv">1674568</span>, <span class="dv">1539668</span>, <span class="dv">1421827</span>, <span class="dv">1829526</span>) <span class="co">#INSEE,2021. La valeur 1012687 correspond à la population dans le 1er arrondissement.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Pour représenter la carte, on utilise la fonction <code>map_sf()</code>. On doit indiquer à minima la variable liée à la statistique (<code>var=pop</code>), et le type de carte (<code>type=prop</code>).</li>
<li>On va superposer 2 cartes: le fond affichant seulement les limites des arrondissements, et celle affichant sous forme de bulle proportionnelles la taille de la population dans chaque arrondissement.</li>
</ul>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Carte avec la fonction mf_map()</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">mf_map</span>(</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="at">x =</span> arrondissements,</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="at">var =</span> <span class="st">"pop"</span> ,</span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="at">type =</span> <span class="st">"prop"</span>,  </span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="at">leg_title =</span> <span class="st">"Population totale\12 271 794"</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="at">add=</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="at">inches=</span><span class="fl">0.2</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="fu">mf_title</span>(<span class="st">"Distribution de la population dans les arrondissements de Paris"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="map_sf_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="map_sf_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="les-cartes-choroplèthes" class="level2">
<h2 class="anchored" data-anchor-id="les-cartes-choroplèthes">Les cartes choroplèthes</h2>
<p>La <em>carte choroplèthe</em> est la représentation à utiliser pour visualiser des ratios (variables quantitatives relatives pour lesquelles la moyenne a un sens, mais dont la somme n’en a pas), et qui sont des variables ordinales.</p>
<p>Sur la carte, on affiche la densité de population de chaque arrondissement. On utilise ici la méthode des quantiles pour discrétiser cette variable, et on applique une palette de couleurs séquentielles avec dégradé pour représenter l’ordre entre les valeurs.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Variable densité de la population</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#création de la variable densite </span></span>
<span id="cb11-2"><a href="#cb11-2"></a>arrondissements<span class="sc">$</span>DENS <span class="ot">&lt;-</span> <span class="fl">1e6</span> <span class="sc">*</span> arrondissements<span class="sc">$</span>pop <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(arrondissements))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Carte avec la fonction mf_map()</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">mf_map</span>(</span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="at">x =</span> arrondissements,</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># variable à représenter: densité de population  </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="at">var =</span> <span class="st">"DENS"</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># type de carte  </span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="at">type =</span> <span class="st">"choro"</span>,</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co"># méthode de dsicrétisation</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="at">breaks =</span> <span class="st">"quantile"</span>,</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># palette de rouges  </span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="at">pal =</span> <span class="st">"Reds"</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="at">leg_title =</span> <span class="st">"Densité de population</span><span class="sc">\n</span><span class="st">(habitants par km2)"</span>, </span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="at">leg_val_rnd =</span> <span class="dv">0</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="map_sf_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="map_sf_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>la faible densité de population des 12e et 16e arrondissement résulte notamment des zônes <em>bois de Vincennes</em> et de <em>Bois de Boulogne</em> qui les composent.</p>
</div>
</div>
</section>
<section id="les-cartes-pour-une-variable-qualitative-nominale" class="level2">
<h2 class="anchored" data-anchor-id="les-cartes-pour-une-variable-qualitative-nominale">Les cartes pour une variable qualitative nominale</h2>
<p>On peut aussi représenter un autre type de variable: qualitative nominale. Pour illuster cette fiche on va représenter les bords politiques des mairies de chaque arrondissement. Pour cela, on produit une carte choroplèthes mais avec des couleurs <em>sans dégradé</em> (palettee qualitative).</p>
<ul>
<li>Penser à trier la base par numéro d’arrondissement avant de fusionner les informations sur les bords politiques (<code>arrange()</code>)</li>
<li>Bien vérifier que les couleurs, ici fortement informatives, correspondent bien aux bords politiques. Sans raison apparente, il a été ici nécessaire de les renseigner dans l’ordre EELV, LR et PS.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>arrondissements2 <span class="ot">=</span> <span class="fu">select</span>(arrondissements, c_ar, l_aroff, geom_x_y, geometry)</span>
<span id="cb13-2"><a href="#cb13-2"></a>arrondissements2 <span class="ot">=</span> <span class="fu">arrange</span>(arrondissements2, c_ar)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>bords_politiques <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LR"</span>, <span class="st">"EELV"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># Le maire du 2e arrondissement de Paris était EELV entre 2014 et 2015.</span></span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>arrondissements2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(arrondissements2, bords_politiques)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># Choix des couleurs</span></span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EELV"</span> <span class="ot">=</span> <span class="st">"#00CC66"</span>, <span class="st">"LR"</span> <span class="ot">=</span> <span class="st">"#0066CC"</span>, <span class="st">"PS"</span> <span class="ot">=</span> <span class="st">"#FF0066"</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co"># Placer les carrés sur les centroïdes des polygones des arrondissements.</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>arr_c<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(arrondissements2)</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a></span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements2, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb13-20"><a href="#cb13-20"></a></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co"># Choix  du symbol rectangle (pch=15)</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="fu">mf_map</span>(</span>
<span id="cb13-23"><a href="#cb13-23"></a>  <span class="at">x =</span> arr_c,</span>
<span id="cb13-24"><a href="#cb13-24"></a>  <span class="at">var =</span> <span class="st">"bords_politiques"</span>,</span>
<span id="cb13-25"><a href="#cb13-25"></a>  <span class="at">pal=</span>colors,</span>
<span id="cb13-26"><a href="#cb13-26"></a>  <span class="at">type=</span><span class="st">"symb"</span>,</span>
<span id="cb13-27"><a href="#cb13-27"></a>  <span class="at">pch=</span><span class="dv">15</span>,</span>
<span id="cb13-28"><a href="#cb13-28"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb13-29"><a href="#cb13-29"></a>  <span class="at">lwd =</span> .<span class="dv">5</span>,</span>
<span id="cb13-30"><a href="#cb13-30"></a>  <span class="at">leg_title =</span> <span class="st">""</span>,</span>
<span id="cb13-31"><a href="#cb13-31"></a>  <span class="at">border=</span><span class="st">"black"</span></span>
<span id="cb13-32"><a href="#cb13-32"></a>)</span>
<span id="cb13-33"><a href="#cb13-33"></a></span>
<span id="cb13-34"><a href="#cb13-34"></a></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co"># habillage additionnel</span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="fu">mf_layout</span>(</span>
<span id="cb13-37"><a href="#cb13-37"></a>  <span class="at">title =</span> <span class="st">"Bord politique des maires de Paris entre 2014 et 2020"</span>,</span>
<span id="cb13-38"><a href="#cb13-38"></a>  <span class="at">credits =</span> <span class="fu">paste0</span>(</span>
<span id="cb13-39"><a href="#cb13-39"></a>    <span class="st">"mapsf "</span>,</span>
<span id="cb13-40"><a href="#cb13-40"></a>    <span class="fu">packageVersion</span>(<span class="st">"mapsf"</span>)</span>
<span id="cb13-41"><a href="#cb13-41"></a>  )</span>
<span id="cb13-42"><a href="#cb13-42"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="map_sf_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="map_sf_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Il est courant de représenter les cartes électorales en remplissant les aires géographiques par des couleurs. Par rapport au graphique précédent, il suffit d’utiliser <code>type="typo"</code> et de retirer l’argument <code>pch</code>. On ajoute également le numéro de l’arrondissement avec la fonction <code>mf_label</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">mf_map</span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="at">x =</span> arrondissements2,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="co"># var à représenter  </span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="at">var =</span> <span class="st">"bords_politiques"</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="at">pal=</span>colors,</span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="at">type=</span><span class="st">"typo"</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="at">lwd =</span> .<span class="dv">5</span>,</span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="at">leg_title =</span> <span class="st">""</span>,</span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="at">leg_pos=</span> <span class="st">"topright"</span>,</span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="at">border=</span><span class="st">"black"</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>)</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="fu">mf_layout</span>(</span>
<span id="cb14-15"><a href="#cb14-15"></a>  <span class="at">title =</span> <span class="st">"Bord politique des maires de Paris entre 2014 et 2020"</span>,</span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="at">credits =</span> <span class="fu">paste0</span>(</span>
<span id="cb14-17"><a href="#cb14-17"></a>    <span class="st">"mapsf "</span>,</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="fu">packageVersion</span>(<span class="st">"mapsf"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a>  )</span>
<span id="cb14-20"><a href="#cb14-20"></a>)</span>
<span id="cb14-21"><a href="#cb14-21"></a></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="fu">mf_label</span>(</span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="at">x =</span> arrondissements2, <span class="at">var =</span> <span class="st">"c_ar"</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">halo =</span> <span class="cn">TRUE</span>, <span class="at">overlap =</span> <span class="cn">FALSE</span>, <span class="at">lines =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-24"><a href="#cb14-24"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="map_sf_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="map_sf_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pour-aller-plus-loin-regroupement-de-polygones" class="level1">
<h1>Pour aller plus loin: regroupement de polygones</h1>
<p>[Maj en cours]</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Code source</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb15" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">---</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="an">title:</span><span class="co"> "Réaliser des cartes thématiques avec Mapsf"</span></span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="an">categories:</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">  - Cartographie</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">  </span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">  - name: "Coralie Cottet"</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">    affiliations:</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">      - name: "Ensai-Ined"</span></span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="an">date:</span><span class="co"> 07/27/2023</span></span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="an">image:</span><span class="co"> "logo.png"</span></span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">  html: default</span></span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="an">filters:</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">  - lightbox</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb15-22"><a href="#cb15-22"></a></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co"> Nous allons montrer comment réaliser des cartes avec R à l'aide du package **`mapsf`** (T.Giraud) et du packages **`sf`**. mapsf est un outil très utile pour manipuler et visualiser des données spatiales en R, tandis que le package "sf" fournit une infrastructure pour stocker et manipuler ce type de données. Ces deux packages offrent une solution simple et pratique pour réaliser ce type d'analyse. </span></span>
<span id="cb15-25"><a href="#cb15-25"></a></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">---</span></span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="al">![](logo.png)</span>{width=10%}</span>
<span id="cb15-29"><a href="#cb15-29"></a></span>
<span id="cb15-30"><a href="#cb15-30"></a>**Documentation** (Timothé Giraud):  </span>
<span id="cb15-31"><a href="#cb15-31"></a></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="ss">*  </span><span class="ot">&lt;https://rcarto.github.io/ined2022/07_mise_en_page.html&gt;</span></span>
<span id="cb15-33"><a href="#cb15-33"></a></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="ss">* </span><span class="ot">&lt;http://riatelab.github.io/mapsf&gt;</span></span>
<span id="cb15-35"><a href="#cb15-35"></a></span>
<span id="cb15-36"><a href="#cb15-36"></a><span class="ss">* </span><span class="ot">&lt;http://rgeomatic.hypotheses.org/2077&gt;</span></span>
<span id="cb15-37"><a href="#cb15-37"></a></span>
<span id="cb15-38"><a href="#cb15-38"></a></span>
<span id="cb15-39"><a href="#cb15-39"></a></span>
<span id="cb15-40"><a href="#cb15-40"></a>**Installation des packages**: </span>
<span id="cb15-41"><a href="#cb15-41"></a></span>
<span id="cb15-42"><a href="#cb15-42"></a><span class="in">```markdown</span></span>
<span id="cb15-43"><a href="#cb15-43"></a>install.packages(mapsf)</span>
<span id="cb15-44"><a href="#cb15-44"></a>install.packages(sf)</span>
<span id="cb15-45"><a href="#cb15-45"></a>install.packages(dplyr)</span>
<span id="cb15-46"><a href="#cb15-46"></a><span class="in">```</span></span>
<span id="cb15-47"><a href="#cb15-47"></a></span>
<span id="cb15-48"><a href="#cb15-48"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb15-49"><a href="#cb15-49"></a><span class="fu">library</span>(mapsf)</span>
<span id="cb15-50"><a href="#cb15-50"></a><span class="fu">library</span>(sf)</span>
<span id="cb15-51"><a href="#cb15-51"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb15-52"><a href="#cb15-52"></a><span class="in">```</span></span>
<span id="cb15-53"><a href="#cb15-53"></a></span>
<span id="cb15-54"><a href="#cb15-54"></a></span>
<span id="cb15-55"><a href="#cb15-55"></a>Nous allons réaliser une carte de Paris avec les données du site de Paris Data [<span class="co">[</span><span class="ot">Lien</span><span class="co">](http://opendata.paris.fr/pages/catalogue/?disjunctive.theme&amp;disjunctive.publisher)</span>]</span>
<span id="cb15-56"><a href="#cb15-56"></a></span>
<span id="cb15-57"><a href="#cb15-57"></a></span>
<span id="cb15-58"><a href="#cb15-58"></a><span class="fu"># Importation des données</span></span>
<span id="cb15-59"><a href="#cb15-59"></a></span>
<span id="cb15-60"><a href="#cb15-60"></a>Il existe plusieurs formats de fond de carte:</span>
<span id="cb15-61"><a href="#cb15-61"></a></span>
<span id="cb15-62"><a href="#cb15-62"></a><span class="ss">* </span>**GeoJSON** est un format de données géospatiales basé sur JSON (JavaScript Object Notation) qui permet de stocker des données géographiques sous forme de caractères.</span>
<span id="cb15-63"><a href="#cb15-63"></a></span>
<span id="cb15-64"><a href="#cb15-64"></a><span class="ss">* </span>**Shapefile** est un format de données géospatiales propriétaire développé par *Esri* (Environmental Systems Research Institute). Il est constitué de plusieurs fichiers qui stockent des informations sur les entités géographiques telles que les points, les lignes et les polygones, ainsi que des attributs associés à ces entités. </span>
<span id="cb15-65"><a href="#cb15-65"></a></span>
<span id="cb15-66"><a href="#cb15-66"></a></span>
<span id="cb15-67"><a href="#cb15-67"></a>Ici le fond importé est en format *GeoJSON*, il correspond aux limites des arrondissements.  On va lui ajouter celui des voies d'eau en couche d'habillage.</span>
<span id="cb15-68"><a href="#cb15-68"></a></span>
<span id="cb15-69"><a href="#cb15-69"></a></span>
<span id="cb15-70"><a href="#cb15-70"></a><span class="in">```{r filename="Importation des données", result=FALSE}</span></span>
<span id="cb15-71"><a href="#cb15-71"></a>arrondissements <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"https://opendata.paris.fr/explore/dataset/arrondissements/download/?format=geojson&amp;timezone=Europe/Berlin&amp;lang=fr"</span>)</span>
<span id="cb15-72"><a href="#cb15-72"></a></span>
<span id="cb15-73"><a href="#cb15-73"></a>cours_deau<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/plan-de-voirie-voies-deau/exports/geojson?lang=fr&amp;timezone=Europe%2FBerlin"</span>)</span>
<span id="cb15-74"><a href="#cb15-74"></a><span class="in">```</span></span>
<span id="cb15-75"><a href="#cb15-75"></a></span>
<span id="cb15-76"><a href="#cb15-76"></a></span>
<span id="cb15-77"><a href="#cb15-77"></a><span class="in">```{r filename="Affichage du fond de carte des arrondissements avec cours d'eau"}</span></span>
<span id="cb15-78"><a href="#cb15-78"></a></span>
<span id="cb15-79"><a href="#cb15-79"></a><span class="co"># Arrondissements</span></span>
<span id="cb15-80"><a href="#cb15-80"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements, <span class="at">border =</span> <span class="st">"black"</span>) </span>
<span id="cb15-81"><a href="#cb15-81"></a></span>
<span id="cb15-82"><a href="#cb15-82"></a><span class="co"># Ajout des cours d'eau</span></span>
<span id="cb15-83"><a href="#cb15-83"></a><span class="fu">mf_map</span>(<span class="at">x=</span>cours_deau,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">border=</span><span class="st">"lightblue"</span>,<span class="at">col=</span><span class="st">"lightblue"</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-84"><a href="#cb15-84"></a><span class="in">```</span></span>
<span id="cb15-85"><a href="#cb15-85"></a></span>
<span id="cb15-86"><a href="#cb15-86"></a><span class="in">```{r filename="Fond noir"}</span></span>
<span id="cb15-87"><a href="#cb15-87"></a><span class="fu">mf_theme</span>(<span class="st">"darkula"</span>)</span>
<span id="cb15-88"><a href="#cb15-88"></a><span class="in">```</span></span>
<span id="cb15-89"><a href="#cb15-89"></a></span>
<span id="cb15-90"><a href="#cb15-90"></a></span>
<span id="cb15-91"><a href="#cb15-91"></a><span class="fu"># Différents types de cartes</span></span>
<span id="cb15-92"><a href="#cb15-92"></a></span>
<span id="cb15-93"><a href="#cb15-93"></a></span>
<span id="cb15-94"><a href="#cb15-94"></a><span class="al">![](arbre_type_data.png)</span></span>
<span id="cb15-95"><a href="#cb15-95"></a></span>
<span id="cb15-96"><a href="#cb15-96"></a><span class="fu">## Les cartes à symboles proportionnels</span></span>
<span id="cb15-97"><a href="#cb15-97"></a></span>
<span id="cb15-98"><a href="#cb15-98"></a>La  carte en symboles proportionnels est la méthode de représentation graphique à utiliser pour visualiser des variables de stocks (variables quantitatives absolues pour lesquelles la somme et la moyenne ont une signification).</span>
<span id="cb15-99"><a href="#cb15-99"></a></span>
<span id="cb15-100"><a href="#cb15-100"></a>Sur la carte, on affiche l'effectif de la population de chaque arrondissement et on ajoute la légende et un titre.</span>
<span id="cb15-101"><a href="#cb15-101"></a></span>
<span id="cb15-102"><a href="#cb15-102"></a><span class="in">```{r filename"Ajout manuel de la population des arrondissements", results= 'hide'}</span></span>
<span id="cb15-103"><a href="#cb15-103"></a><span class="co">#Ajout manuel des valeurs des populations de chaque arrondissements dans le tableau sous le nom "pop"</span></span>
<span id="cb15-104"><a href="#cb15-104"></a>arrondissements<span class="sc">$</span>pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1012687</span>, <span class="dv">903036</span>, <span class="dv">1369857</span>, <span class="dv">1491027</span>, <span class="dv">1672009</span>, <span class="dv">1506475</span>, <span class="dv">1637163</span>, <span class="dv">1603380</span>, <span class="dv">1637542</span>, <span class="dv">1059282</span>, <span class="dv">1494945</span>, <span class="dv">1436205</span>, <span class="dv">1705774</span>, <span class="dv">1425805</span>, <span class="dv">236769</span>, <span class="dv">1668605</span>, <span class="dv">1674568</span>, <span class="dv">1539668</span>, <span class="dv">1421827</span>, <span class="dv">1829526</span>) <span class="co">#INSEE,2021. La valeur 1012687 correspond à la population dans le 1er arrondissement.</span></span>
<span id="cb15-105"><a href="#cb15-105"></a><span class="in">```</span></span>
<span id="cb15-106"><a href="#cb15-106"></a></span>
<span id="cb15-107"><a href="#cb15-107"></a></span>
<span id="cb15-108"><a href="#cb15-108"></a><span class="ss">* </span>Pour représenter la carte, on utilise la fonction <span class="in">`map_sf()`</span>. On doit indiquer à minima la variable liée à la statistique (<span class="in">`var=pop`</span>), et le type de carte (<span class="in">`type=prop`</span>). </span>
<span id="cb15-109"><a href="#cb15-109"></a><span class="ss">* </span>On va superposer 2 cartes: le fond affichant seulement les limites des arrondissements, et celle affichant sous forme de bulle proportionnelles la taille de la population dans chaque arrondissement.</span>
<span id="cb15-110"><a href="#cb15-110"></a></span>
<span id="cb15-111"><a href="#cb15-111"></a></span>
<span id="cb15-112"><a href="#cb15-112"></a><span class="in">```{r filename="Carte avec la fonction mf_map()"}</span></span>
<span id="cb15-113"><a href="#cb15-113"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements)</span>
<span id="cb15-114"><a href="#cb15-114"></a><span class="fu">mf_map</span>(</span>
<span id="cb15-115"><a href="#cb15-115"></a>  <span class="at">x =</span> arrondissements,</span>
<span id="cb15-116"><a href="#cb15-116"></a>  <span class="at">var =</span> <span class="st">"pop"</span> ,</span>
<span id="cb15-117"><a href="#cb15-117"></a>  <span class="at">type =</span> <span class="st">"prop"</span>,  </span>
<span id="cb15-118"><a href="#cb15-118"></a>  <span class="at">leg_title =</span> <span class="st">"Population totale\12 271 794"</span>,</span>
<span id="cb15-119"><a href="#cb15-119"></a>  <span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb15-120"><a href="#cb15-120"></a>  <span class="at">add=</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-121"><a href="#cb15-121"></a>  <span class="at">inches=</span><span class="fl">0.2</span>)</span>
<span id="cb15-122"><a href="#cb15-122"></a></span>
<span id="cb15-123"><a href="#cb15-123"></a><span class="fu">mf_title</span>(<span class="st">"Distribution de la population dans les arrondissements de Paris"</span>)</span>
<span id="cb15-124"><a href="#cb15-124"></a><span class="in">```</span></span>
<span id="cb15-125"><a href="#cb15-125"></a></span>
<span id="cb15-126"><a href="#cb15-126"></a><span class="fu">## Les cartes choroplèthes</span></span>
<span id="cb15-127"><a href="#cb15-127"></a></span>
<span id="cb15-128"><a href="#cb15-128"></a>La *carte choroplèthe* est la représentation  à utiliser pour visualiser des ratios (variables quantitatives relatives pour lesquelles la moyenne a un sens, mais dont la somme n'en a pas), et qui sont des variables ordinales.</span>
<span id="cb15-129"><a href="#cb15-129"></a></span>
<span id="cb15-130"><a href="#cb15-130"></a>Sur la carte, on affiche la densité de population de chaque arrondissement. On utilise ici la méthode des quantiles pour discrétiser cette variable, et on applique une palette de couleurs séquentielles avec dégradé pour représenter l'ordre entre les valeurs.</span>
<span id="cb15-131"><a href="#cb15-131"></a></span>
<span id="cb15-132"><a href="#cb15-132"></a><span class="in">```{r filename="Variable densité de la population"}</span></span>
<span id="cb15-133"><a href="#cb15-133"></a><span class="co">#création de la variable densite </span></span>
<span id="cb15-134"><a href="#cb15-134"></a>arrondissements<span class="sc">$</span>DENS <span class="ot">&lt;-</span> <span class="fl">1e6</span> <span class="sc">*</span> arrondissements<span class="sc">$</span>pop <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(arrondissements))</span>
<span id="cb15-135"><a href="#cb15-135"></a><span class="in">```</span></span>
<span id="cb15-136"><a href="#cb15-136"></a></span>
<span id="cb15-137"><a href="#cb15-137"></a><span class="in">```{r filename="Carte avec la fonction mf_map()"}</span></span>
<span id="cb15-138"><a href="#cb15-138"></a><span class="fu">mf_map</span>(</span>
<span id="cb15-139"><a href="#cb15-139"></a>  <span class="at">x =</span> arrondissements,</span>
<span id="cb15-140"><a href="#cb15-140"></a><span class="co"># variable à représenter: densité de population  </span></span>
<span id="cb15-141"><a href="#cb15-141"></a><span class="at">var =</span> <span class="st">"DENS"</span>,</span>
<span id="cb15-142"><a href="#cb15-142"></a><span class="co"># type de carte  </span></span>
<span id="cb15-143"><a href="#cb15-143"></a><span class="at">type =</span> <span class="st">"choro"</span>,</span>
<span id="cb15-144"><a href="#cb15-144"></a><span class="co"># méthode de dsicrétisation</span></span>
<span id="cb15-145"><a href="#cb15-145"></a>  <span class="at">breaks =</span> <span class="st">"quantile"</span>,</span>
<span id="cb15-146"><a href="#cb15-146"></a><span class="co"># palette de rouges  </span></span>
<span id="cb15-147"><a href="#cb15-147"></a><span class="at">pal =</span> <span class="st">"Reds"</span>,</span>
<span id="cb15-148"><a href="#cb15-148"></a>  <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb15-149"><a href="#cb15-149"></a>  <span class="at">leg_title =</span> <span class="st">"Densité de population</span><span class="sc">\n</span><span class="st">(habitants par km2)"</span>, </span>
<span id="cb15-150"><a href="#cb15-150"></a>  <span class="at">leg_val_rnd =</span> <span class="dv">0</span></span>
<span id="cb15-151"><a href="#cb15-151"></a>)</span>
<span id="cb15-152"><a href="#cb15-152"></a><span class="in">```</span></span>
<span id="cb15-153"><a href="#cb15-153"></a></span>
<span id="cb15-154"><a href="#cb15-154"></a></span>
<span id="cb15-155"><a href="#cb15-155"></a>::: callout-note </span>
<span id="cb15-156"><a href="#cb15-156"></a>la faible densité de population des 12e et 16e arrondissement résulte notamment des zônes *bois de Vincennes* et de *Bois de Boulogne* qui les composent.</span>
<span id="cb15-157"><a href="#cb15-157"></a>:::</span>
<span id="cb15-158"><a href="#cb15-158"></a></span>
<span id="cb15-159"><a href="#cb15-159"></a></span>
<span id="cb15-160"><a href="#cb15-160"></a><span class="fu">## Les cartes pour une variable qualitative nominale</span></span>
<span id="cb15-161"><a href="#cb15-161"></a></span>
<span id="cb15-162"><a href="#cb15-162"></a>On peut aussi représenter un autre type de variable: qualitative nominale. Pour illuster cette fiche on va représenter les bords politiques des mairies de chaque arrondissement.</span>
<span id="cb15-163"><a href="#cb15-163"></a>Pour cela, on produit une carte choroplèthes mais avec des couleurs *sans dégradé* (palettee qualitative).  </span>
<span id="cb15-164"><a href="#cb15-164"></a></span>
<span id="cb15-165"><a href="#cb15-165"></a><span class="ss">* </span>Penser à trier la base par numéro d'arrondissement avant de fusionner les informations sur les bords politiques (<span class="in">`arrange()`</span>)</span>
<span id="cb15-166"><a href="#cb15-166"></a><span class="ss">* </span>Bien vérifier que les couleurs, ici fortement informatives, correspondent bien aux bords politiques. Sans raison apparente, il a été ici nécessaire de les renseigner dans l'ordre EELV, LR et PS. </span>
<span id="cb15-167"><a href="#cb15-167"></a></span>
<span id="cb15-168"><a href="#cb15-168"></a></span>
<span id="cb15-169"><a href="#cb15-169"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb15-170"><a href="#cb15-170"></a>arrondissements2 <span class="ot">=</span> <span class="fu">select</span>(arrondissements, c_ar, l_aroff, geom_x_y, geometry)</span>
<span id="cb15-171"><a href="#cb15-171"></a>arrondissements2 <span class="ot">=</span> <span class="fu">arrange</span>(arrondissements2, c_ar)</span>
<span id="cb15-172"><a href="#cb15-172"></a></span>
<span id="cb15-173"><a href="#cb15-173"></a>bords_politiques <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LR"</span>, <span class="st">"EELV"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"LR"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>, <span class="st">"PS"</span>)</span>
<span id="cb15-174"><a href="#cb15-174"></a><span class="co"># Le maire du 2e arrondissement de Paris était EELV entre 2014 et 2015.</span></span>
<span id="cb15-175"><a href="#cb15-175"></a></span>
<span id="cb15-176"><a href="#cb15-176"></a></span>
<span id="cb15-177"><a href="#cb15-177"></a>arrondissements2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(arrondissements2, bords_politiques)</span>
<span id="cb15-178"><a href="#cb15-178"></a></span>
<span id="cb15-179"><a href="#cb15-179"></a><span class="co"># Choix des couleurs</span></span>
<span id="cb15-180"><a href="#cb15-180"></a></span>
<span id="cb15-181"><a href="#cb15-181"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EELV"</span> <span class="ot">=</span> <span class="st">"#00CC66"</span>, <span class="st">"LR"</span> <span class="ot">=</span> <span class="st">"#0066CC"</span>, <span class="st">"PS"</span> <span class="ot">=</span> <span class="st">"#FF0066"</span>)</span>
<span id="cb15-182"><a href="#cb15-182"></a></span>
<span id="cb15-183"><a href="#cb15-183"></a><span class="co"># Placer les carrés sur les centroïdes des polygones des arrondissements.</span></span>
<span id="cb15-184"><a href="#cb15-184"></a>arr_c<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(arrondissements2)</span>
<span id="cb15-185"><a href="#cb15-185"></a></span>
<span id="cb15-186"><a href="#cb15-186"></a></span>
<span id="cb15-187"><a href="#cb15-187"></a></span>
<span id="cb15-188"><a href="#cb15-188"></a><span class="fu">mf_map</span>(<span class="at">x =</span> arrondissements2, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb15-189"><a href="#cb15-189"></a></span>
<span id="cb15-190"><a href="#cb15-190"></a><span class="co"># Choix  du symbol rectangle (pch=15)</span></span>
<span id="cb15-191"><a href="#cb15-191"></a><span class="fu">mf_map</span>(</span>
<span id="cb15-192"><a href="#cb15-192"></a>  <span class="at">x =</span> arr_c,</span>
<span id="cb15-193"><a href="#cb15-193"></a>  <span class="at">var =</span> <span class="st">"bords_politiques"</span>,</span>
<span id="cb15-194"><a href="#cb15-194"></a>  <span class="at">pal=</span>colors,</span>
<span id="cb15-195"><a href="#cb15-195"></a>  <span class="at">type=</span><span class="st">"symb"</span>,</span>
<span id="cb15-196"><a href="#cb15-196"></a>  <span class="at">pch=</span><span class="dv">15</span>,</span>
<span id="cb15-197"><a href="#cb15-197"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb15-198"><a href="#cb15-198"></a>  <span class="at">lwd =</span> .<span class="dv">5</span>,</span>
<span id="cb15-199"><a href="#cb15-199"></a>  <span class="at">leg_title =</span> <span class="st">""</span>,</span>
<span id="cb15-200"><a href="#cb15-200"></a>  <span class="at">border=</span><span class="st">"black"</span></span>
<span id="cb15-201"><a href="#cb15-201"></a>)</span>
<span id="cb15-202"><a href="#cb15-202"></a></span>
<span id="cb15-203"><a href="#cb15-203"></a></span>
<span id="cb15-204"><a href="#cb15-204"></a><span class="co"># habillage additionnel</span></span>
<span id="cb15-205"><a href="#cb15-205"></a><span class="fu">mf_layout</span>(</span>
<span id="cb15-206"><a href="#cb15-206"></a>  <span class="at">title =</span> <span class="st">"Bord politique des maires de Paris entre 2014 et 2020"</span>,</span>
<span id="cb15-207"><a href="#cb15-207"></a>  <span class="at">credits =</span> <span class="fu">paste0</span>(</span>
<span id="cb15-208"><a href="#cb15-208"></a>    <span class="st">"mapsf "</span>,</span>
<span id="cb15-209"><a href="#cb15-209"></a>    <span class="fu">packageVersion</span>(<span class="st">"mapsf"</span>)</span>
<span id="cb15-210"><a href="#cb15-210"></a>  )</span>
<span id="cb15-211"><a href="#cb15-211"></a>)</span>
<span id="cb15-212"><a href="#cb15-212"></a></span>
<span id="cb15-213"><a href="#cb15-213"></a><span class="in">```</span></span>
<span id="cb15-214"><a href="#cb15-214"></a></span>
<span id="cb15-215"><a href="#cb15-215"></a></span>
<span id="cb15-216"><a href="#cb15-216"></a>Il est courant de représenter les cartes électorales en remplissant les aires géographiques par des couleurs. Par rapport </span>
<span id="cb15-217"><a href="#cb15-217"></a>au graphique précédent, il suffit d'utiliser <span class="in">`type="typo"`</span> et de retirer l'argument <span class="in">`pch`</span>. On ajoute également le numéro de l'arrondissement avec la fonction <span class="in">`mf_label`</span>.</span>
<span id="cb15-218"><a href="#cb15-218"></a></span>
<span id="cb15-221"><a href="#cb15-221"></a><span class="in">```{r}</span></span>
<span id="cb15-222"><a href="#cb15-222"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-223"><a href="#cb15-223"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb15-224"><a href="#cb15-224"></a></span>
<span id="cb15-225"><a href="#cb15-225"></a><span class="fu">mf_map</span>(</span>
<span id="cb15-226"><a href="#cb15-226"></a>  <span class="at">x =</span> arrondissements2,</span>
<span id="cb15-227"><a href="#cb15-227"></a>  <span class="co"># var à représenter  </span></span>
<span id="cb15-228"><a href="#cb15-228"></a>  <span class="at">var =</span> <span class="st">"bords_politiques"</span>,</span>
<span id="cb15-229"><a href="#cb15-229"></a>  <span class="at">pal=</span>colors,</span>
<span id="cb15-230"><a href="#cb15-230"></a>  <span class="at">type=</span><span class="st">"typo"</span>,</span>
<span id="cb15-231"><a href="#cb15-231"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb15-232"><a href="#cb15-232"></a>  <span class="at">lwd =</span> .<span class="dv">5</span>,</span>
<span id="cb15-233"><a href="#cb15-233"></a>  <span class="at">leg_title =</span> <span class="st">""</span>,</span>
<span id="cb15-234"><a href="#cb15-234"></a>  <span class="at">leg_pos=</span> <span class="st">"topright"</span>,</span>
<span id="cb15-235"><a href="#cb15-235"></a>  <span class="at">border=</span><span class="st">"black"</span></span>
<span id="cb15-236"><a href="#cb15-236"></a>)</span>
<span id="cb15-237"><a href="#cb15-237"></a></span>
<span id="cb15-238"><a href="#cb15-238"></a><span class="fu">mf_layout</span>(</span>
<span id="cb15-239"><a href="#cb15-239"></a>  <span class="at">title =</span> <span class="st">"Bord politique des maires de Paris entre 2014 et 2020"</span>,</span>
<span id="cb15-240"><a href="#cb15-240"></a>  <span class="at">credits =</span> <span class="fu">paste0</span>(</span>
<span id="cb15-241"><a href="#cb15-241"></a>    <span class="st">"mapsf "</span>,</span>
<span id="cb15-242"><a href="#cb15-242"></a>    <span class="fu">packageVersion</span>(<span class="st">"mapsf"</span>)</span>
<span id="cb15-243"><a href="#cb15-243"></a>  )</span>
<span id="cb15-244"><a href="#cb15-244"></a>)</span>
<span id="cb15-245"><a href="#cb15-245"></a></span>
<span id="cb15-246"><a href="#cb15-246"></a><span class="fu">mf_label</span>(</span>
<span id="cb15-247"><a href="#cb15-247"></a>  <span class="at">x =</span> arrondissements2, <span class="at">var =</span> <span class="st">"c_ar"</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">halo =</span> <span class="cn">TRUE</span>, <span class="at">overlap =</span> <span class="cn">FALSE</span>, <span class="at">lines =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-248"><a href="#cb15-248"></a>)</span>
<span id="cb15-249"><a href="#cb15-249"></a><span class="in">```</span></span>
<span id="cb15-250"><a href="#cb15-250"></a></span>
<span id="cb15-251"><a href="#cb15-251"></a></span>
<span id="cb15-252"><a href="#cb15-252"></a><span class="fu"># Pour aller plus loin: regroupement de polygones</span></span>
<span id="cb15-253"><a href="#cb15-253"></a></span>
<span id="cb15-254"><a href="#cb15-254"></a></span>
<span id="cb15-255"><a href="#cb15-255"></a><span class="co">[</span><span class="ot">Maj en cours</span><span class="co">]</span></span>
<span id="cb15-256"><a href="#cb15-256"></a></span>
<span id="cb15-257"><a href="#cb15-257"></a></span>
<span id="cb15-258"><a href="#cb15-258"></a></span>
<span id="cb15-259"><a href="#cb15-259"></a></span>
</code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","loop":true,"selector":".lightbox","closeEffect":"zoom","openEffect":"zoom"});</script>



</body></html>